{
    "comic_number": 2435,
    "explanation": "{{comic\n| number    = 2435\n| date      = March 10, 2021\n| title     = Geothmetic Meandian\n| image     = geothmetic_meandian.png\n| titletext = Pythagorean means are nice and all, but throwing the median in the pot is really what turns this into random forest statistics: applying every function you can think of, and then gradually dropping the ones that make the result worse.\n}}\n==Explanation==\nThis is another one of [[Randall|Randall's]] [[:Category:Tips|Tips]], this time a stats tip. This came as the first tip comic after the statistics tip in [[2400: Statistics]].\n\nThere are a number of different ways to identify the \"{{w|average}}\" value of a series of values, the most common unweighted methods being the {{w|median}} (take the central value from the ordered list of values if there are an odd number - or the value half-way between the two that straddle the divide between two halves if there are an even number) and the {{w|arithmetic mean}} (add all the numbers up, divide by the number of numbers). The {{w|geometric mean}} is less well-known but works similarly to the arithmetic mean. The geometric mean of ''n'' positive numbers is the ''n''th root of the product of those numbers. If all of the numbers in a sequence are identical, then its arithmetic mean, geometric mean and median will be identical, since they would all be equal to the common value of the terms of the sequence. However, if the sequence is not constant, then {{w|Inequality_of_arithmetic_and_geometric_means#Geometric_interpretation|the arithmetic mean will be greater than the geometric mean}}, and the median may be different than either of those means.\n\nThe geometric mean, arithmetic mean, and the {{w|harmonic mean}} (not shown) are collectively known as the {{w|Pythagorean means}}, as specific modes of a greater and more generalized mean formula that extends arbitrarily to various other possible nuances of mean-value rationisations (cubic, etc.).\n\n{{w|Outlier}}s and internal biases within the original sample can make boiling down a set of values into a single 'average' sometimes overly biased by flaws in the data, with your choice of which method to use perhaps resulting in a value that is misleading, exaggerating or suppressing the significance of any blips.\n\nIn this depiction, the three named methods of averaging are embedded within a single function that produces a sequence of three values - one output for each of the methods. Being a series of values, Randall suggests that this is ideally suited to being ''itself'' subjected to the comparative 'averaging' method. Not just once, but as many times as it takes to narrow down to a sequence of three values that are very close to one another. \n\nIt can be shown that the xkcd value of 2.089 for GMDN(1,1,2,3,5) is validated:\n\n{|-border =1 width=100% cellpadding=5 class=\"wikitable\"\n !\n ! Arithmetic mean \n ! Geometric mean \n ! Median\n |-\n ! F1 \n | 2.4 || 1.974350486 || 2\t\t\n |-\n ! F2\n | '''2.124783495''' ||\t2.116192461 || 2\t\t\n |-\n ! F3\n | 2.080325319 || 2.079536819 || '''2.116192461'''\t\n |-\n ! F4\n | '''2.0920182''' || 2.091948605 || 2.080325319\t\n |-\n ! F5\n | 2.088097374 || 2.088090133 || '''2.091948605'''\t\t\n |-\n ! F6\n | '''2.089378704''' ||\t2.089377914 || 2.088097374\t\t\n |-\n ! F7\n | 2.088951331 ||\t2.088951244 || '''2.089377914'''\t\n |-\n ! F8\n | '''2.089093496''' || 2.089093487 || 2.088951331\t\n |-\n ! F9\n | 2.089046105 || 2.089046103 || '''2.089093487'''\t\n |-\n ! F10\n | '''2.089061898''' || 2.089061898 || 2.089046105\t\t\n |}\n\nEach row in this table shows the set Fn(..) composed of the average, geomean and median computed on the previous row, with the sequence {1,1,2,3,5} as the initial F0. While GMDN is not differentiable, due to the median, this can be interpreted as somewhat similar to a heat equation which approaches equilibrium through averaging. Interestingly, the maximum value alternates between the average and the median (highlighted in bold in the table), while the minimum value alternates between the geomean and the median. This observation holds for many inputs.\n\nTo not distract from the comedic effect, the definition of the GMDN in the comic is left as a simplified sketch. To make the definition mathematically rigorous the implied infinite limit in the second line can be made precise, for example, as the result of a {{w|fixed-point iteration}} via <code>G = lim_{k -> infinity} m_k </code> where <code>m_0 = F(x_1, x_2, ..., x_n)</code> and <code>m_{k+1} = F(m_k) for k > 0</code>. This definition is well-defined only if we can proof convergence to a fixpoint of F for a set of inputs. Indeed, convergence holds if all numbers are non-negative (see discussions for proof and more cases). Note that the above definition yields a three-dimensional fixpoint G. Because all fixpoints of F are of the form <code>G=(g, g, g)</code>, with elements that are all equal, we can define <code>GMDN(x_1, x_2, ..., x_n) = G_1</code>, as the first element of G. This formal definition avoids the inconsistency present in the comic's definition sketch where the function GMDN as defined in the second line has the same three-dimensional output as F, but GMDN in the last line is shown to produce a single real number rather than a vector and is thus missing a final operation of returning a single component. Note also that the comic's definition of the median as the (n+1)/2-th {{w|order statistic}}, i.e. the (n+1)/2-th smallest value, coincides with the more regularly used sample median only on lists of odd length. For lists of even length the sample median is usually defined as the (arithmetic) mean of the two middle values <code>X_{n/2}</code> and <code>X_{(n+2)/2}</code> instead. Indeed, for lists of even lengths <code>X_{(n+1)/2}</code> is not well-defined without adding a flooring operation as (n+1)/2 is not an integer.\n\nThe comment in the title text about suggests that this will save you the trouble of committing to the 'wrong' analysis as it gradually shaves down any 'outlier average' that is unduly affected by anomalies in the original inputs. It is a method without any danger of divergence of values, since all three averaging methods stay within the interval covering the input values (and two of them will stay strictly within that interval).\n\nThe title text may also be a sly reference to an actual mathematical theorem, namely that if one performs this procedure only using the arithmetic mean and the harmonic mean, the result will converge to the geometric mean. Randall suggests that the (non-Pythagorean) median, which does not have such good mathematical properties with relation to convergence, is, in fact, the secret sauce in his definition.\n\nThe question of being unsure of which mean to use is especially relevant for the arithmetic and harmonic means in following example.\n   * Cueball has some US Dollars and wishes to buy Euros. Suppose the bank will exchange US Dollars to Euros at a rate of €5 for $6 (about 0.83333€/$ or 1.20000$/€).\n   * Megan   has some Euros and wishes to buy US Dollars. Suppose the bank will exchange Euros to US Dollars at a rate of $7 for €6 (about 0.85714€/$ or 1.16667$/€).\n[[Cueball]] and [[Megan]] decide to complete the exchange between themselves in order to save the {{w|Bid-ask spread}} of the {{w|Exchange rate}} which is the cost the bank imposes on Cueball and Megan for its service as a {{w|Market maker}}. \n   * Cueball offers to split the difference by averaging the rates €5:$6 and €6:$7 yielding a rate of €71:$84 (about 0.84524€/$ or 1.18310$/€).\n   * Megan   offers to split the difference by averaging the rates $6:€5 and $7:€6 yielding a rate of €60:$71 (about 0.84507€/$ or 1.18333$/€).\nIn one direction (€/$), Cueball is using the arithmetic mean but Megan is using the harmonic mean while in the other direction ($/€), Megan is using the arithmetic mean but Cueball is using the harmonic mean. This creates two new exchange rates which are closer than the orginal rates, but the new rates are still different for each other. Megan and Cueball can then iterate this process and the rates will converge to the geometric mean of the original rates, namely:\n   * sqrt((5/6)*(6/7)) = sqrt(5/7) = 0.84515€/$ or\n   * sqrt((6/5)*(7/6)) = sqrt(7/5) = 1.18322$/€.\n\nThere does exist an {{w|arithmetic-geometric mean}}, which is defined identically to this except with the arithmetic and geometric means, and sees some use in calculus.  In some ways it's also philosophically similar to the {{w|truncated mean}} (extremities of the value range, e.g. the highest and lowest 10%s, are ignored as not acceptable and not counted) or {{w|Winsorized mean}} (instead of ignored, the values are readjusted to be the chosen floor/ceiling values that they lie beyond, to still effectively be counted as \"edge\" conditions), only with a strange dilution-and-compromise method rather than one where quantities can be culled or neutered just for being unexpectedly different from most of the other data.\n\nThe input sequence of numbers (1, 1, 2, 3, 5) chosen by Randall is also the opening of the {{w|Fibonacci sequence}}.  This may have been selected because the Fibonacci sequence also has a convergent property: the ratio of two adjacent numbers in the sequence approaches the {{w|Golden ratio#Relationship to Fibonacci sequence|golden ratio}} as the length of the sequence approaches infinity.\n\nHere is a table of averages classified by the various methods referenced:\n\n{|border =1 width=100% cellpadding=5 class=\"wikitable\"\n|+ averages using various methods\n! Method \n! Value\n! Formula\n|-\n! Arithmetic\n| 2.4\n| Add all numbers, then divide the sum by n, where n is the number of terms.\n|-\n! Geometric\n| 1.9743504858348\n| Multiply all numbers, then take the product's nth root, where n is the number of terms.\n|-\n! Median \n| 2\n| Find the term or terms which separate the upper half of the set from the lower set. If the set has an even number of terms, find the arithmetic mean of the middle two terms.\n|-\n! GMDN \n| 2.089\n| (see above)\n|}\n\n==Transcript==\n\nF(x1,x2,...xn)=({x1+x2+...+xn/n [bracket: arithmetic mean]},{nx,x2...xn, [bracket: geometric mean]} {x n+1/2 [bracket: median]})\n\nGmdn(x1,x2,...xn)={F(F(F(...F(x1,x2,...xn)...)))[bracket: geothmetic meandian]}\n\nGmdn(1,1,2,3,5) [equals about sign] 2.089\n\nCaption: Stats tip: If you aren't sure whether to use the mean, median, or geometric mean, just calculate all three, then repeat until it converges\n\n==Trivia==\nGeothm means \"counting earths\" (From Ancient Greek γεω- (geō-), combining form of γῆ (gê, “earth”) and ἀριθμός arithmos, 'counting').  Geothmetic means \"art of Geothming\" based on the etymology of Arithmetic (from Ancient Greek ἀριθμητική (τέχνη) (arithmētikḗ (tékhnē), “(art of) counting”).  This is an exciting new terminology that is eminently suitable for modern cosmology & high energy physics - particularly when doing math on the multiverse.  However, it is unlikely this etymology is related to the term \"geothmetic meandian\" as coined by Randall, as it can be more simply explained as a portmanteau of the three averages in its construction: '''geo'''metric mean, ari'''thmetic mean''', and me'''dian'''.\n\nThe following Python code (inefficiently) implements the above algorithm for a list of non-negative numbers:\n\n<pre>\nfrom functools import reduce\n\n\ndef f(*args):\n    args = sorted(args)\n    mean = sum(args) / len(args)\n    gmean = reduce(lambda x, y: x * y, args) ** (1 / len(args))\n    if len(args) % 2:\n        median = args[len(args) // 2]\n    else:\n        median = (args[len(args) // 2] + args[len(args) // 2 - 1]) / 2\n    return mean, gmean, median\n\n\nmax_iterations = 10\nl = [1, 1, 2, 3, 5]\nfor iterations in range(max_iterations):\n    fst, *rest = l\n    if all((abs(r - fst) < 0.00000001 for r in rest)):\n        break\n    l = f(*l)\nprint(l[0], iterations)\n</pre>\nHere is a slightly more efficient version of the Python code:\n\n<pre>\nfrom scipy.stats.mstats import gmean\nimport numpy as np\n\n\ndef get_centers(a, tol=0.00001, print_rows = True):\n    a = np.array(a)\n    l_of_a = len(a)\n    if l_of_a == 1:\n        return a[0]\n    elif l_of_a > 2: \n        result = all(\n            (\n                np.abs(a[0] / a[1]) <= tol,\n                np.abs(a[0] / a[2]) <= tol,\n                np.abs(a[1] / a[2]) <= tol,\n            )\n        )\n        if result:\n            return a[0]\n    res = [np.mean(a), np.median(a), gmean(a)]\n\n    if print_rows:\n        print(res)\n    return get_centers(res, tol)\n\n</pre>\n\nAnd here is an implementation of the Gmdn function in R:\n\n    Gmdn <- function (..., threshold = 1E-6) {\n      # Function F(x) as defined in comic\n      f <- function (x) {\n        n <- length(x)\n        return(c(mean(x), prod(x)^(1/n), median(x)))\n      }\n      # Extract input vector from ... argument\n      x <- c(...)\n      # Iterate until the standard deviation of f(x) reaches a threshold\n      while (sd(x) > threshold) x <- f(x)\n      # Return the mean of the final triplet\n      return(mean(x))\n    }\n\n\n{{comic discussion}}\n<!--\nFor a start, there is a syntax error. After the first application of F, you get a 3-tuple. Subsequent iterations preserve the 3-tuple, and we need to analyze the resulting sequence.\nPerhaps there is an implicit claim all three entries converge to the same result. In any case, lets see what we get:\n\nWlog, we have three inputs (x_1,y_1,z_1), and want to understand the iterates of the map \nF(x,y,z) = ( (x+y+z)/3, cube root of (xyz), median(x,y,z) ). Lets write F(x_n,y_n,z_n) = (x_{n+1},y_{n+1},z_{n+1}).\n\nThe inequality of arithmetic and geometric means gives x_n \\geq y_n, if n \\geq 2,  and\n-->\n\n[[Category:Math]]\n[[Category:Statistics]]\n[[Category:Portmanteau]]\n[[Category:Tips]]"
}